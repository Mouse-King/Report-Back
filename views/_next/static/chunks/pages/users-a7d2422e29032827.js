(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{7787:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return t(8077)}])},3626:function(e,s,t){"use strict";var a=t(5893),r=t(8396),i=t(1732),l=t(7451),n=t(3664),o=t(7632),d=t(1958),c=t(4808),u=t(8456),m=t(8756),x=t(5715);let p=e=>{let{children:s,contentHeightFixed:t}=e,{settings:p,saveSettings:h}=(0,m.r)(),{spinning:Z}=(0,x.a)(),f=(0,r.Z)(e=>e.breakpoints.down("lg"));return f&&"horizontal"===p.layout&&(p.layout="vertical"),(0,a.jsxs)(i.Z,{hidden:f,settings:p,saveSettings:h,contentHeightFixed:t,verticalLayoutProps:{navMenu:{navItems:(0,l.Z)()},appBar:{content:e=>(0,a.jsx)(o.Z,{hidden:f,settings:p,saveSettings:h,toggleNavVisibility:e.toggleNavVisibility})}},..."horizontal"===p.layout&&{horizontalLayoutProps:{navMenu:{navItems:(0,n.Z)()},appBar:{content:()=>(0,a.jsx)(d.Z,{settings:p,saveSettings:h})}}},children:[s,(0,a.jsx)(c.Z,{sx:{color:"#fafafa",background:"#000000dd",zIndex:1e4},open:Z,children:(0,a.jsx)(u.Z,{color:"inherit"})})]})};s.Z=p},8181:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(657),i=t(7645),l=t(5861),n=t(3946),o=t(6580),d=t(6886),c=t(7357),u=t(3321),m=t(1903),x=t(4054),p=t(3841),h=t(8360),Z=t(7918),f=t(8972),j=t(1425),g=t(5675),v=t.n(g),P=t(7294),w=t(6501),y=t(9878),b=t(1566);let C={PaperProps:{style:{maxHeight:224,width:250}}},S=e=>{let{open:s,reports:t,user:g,handleClose:S,initialize:k}=e,N=(0,P.useRef)(null),[z,W]=(0,P.useState)("/images/avatars/1.png"),[_,M]=(0,P.useState)(null),[E,R]=(0,P.useState)(""),[A,I]=(0,P.useState)(""),[D,L]=(0,P.useState)(""),[F,H]=(0,P.useState)(""),[B,U]=(0,P.useState)(""),[G,V]=(0,P.useState)(!1),[O,J]=(0,P.useState)(!1),[K,T]=(0,P.useState)([]);(0,P.useEffect)(()=>{s&&X()},[s]);let X=async()=>{var e;W(g.avatar?"/uploads/users/".concat(g.avatar):"/images/avatars/1.png"),M(null),R(null==g?void 0:g.firstName),I(null==g?void 0:g.lastName),L(null==g?void 0:g.email),H(""),U(""),T((null==g?void 0:null===(e=g.reports)||void 0===e?void 0:e.map(e=>{let{_id:s}=e;return s}))||[])},$=()=>{V(!G)},Y=()=>{J(!O)},q=e=>{let{target:{value:s}}=e;T("string"==typeof s?s.split(","):s)},Q=e=>{let s;return t.map((t,a)=>{t._id==e&&(s=t.name)}),s},ee=e=>{N.current.click()},es=e=>{let s=e.target.files[0],t=new FileReader;M(s),t.onload=()=>W(t.result),t.readAsDataURL(s)},et=e=>{W("/images/avatars/1.png"),M(null)},ea=async()=>{if(""===E.trim())w.ZP.error("Please enter a first name.");else if(""===A.trim())w.ZP.error("Please enter a last name.");else if(""===D.trim())w.ZP.error("Please enter a email.");else if(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g.test(D)){if(""!==F.trim()&&F.length<6)w.ZP.error("Password must be at least 6 characters");else if(""!==F.trim()&&""===B.trim())w.ZP.error("Please enter a confirm password.");else if(""!==F.trim()&&F!==B)w.ZP.error("Passwords must match");else if(0==K.length)w.ZP.error("Please select the report");else{let e=new FormData;_&&e.append("avatar",_),e.append("firstName",E),e.append("lastName",A),e.append("email",D),""!==F.trim()&&e.append("password",F),e.append("reports",K);let{data:s}=await b.Z.put("/admin/users/".concat(g._id),e);s.status?(w.ZP.success(s.msg),S(),k()):w.ZP.error(s.msg)}}else w.ZP.error("Please enter a valid email.")};return(0,a.jsxs)(r.Z,{fullWidth:!0,maxWidth:"xs",open:s,sx:{"& .MuiPaper-root":{maxWidth:500}},children:[(0,a.jsxs)(i.Z,{sx:{mb:3},children:[(0,a.jsx)(l.Z,{component:"span",variant:"h5",children:"Edit User"}),(0,a.jsx)(n.Z,{onClick:S,sx:{position:"absolute",right:12,top:10,color:"#aaa"},children:(0,a.jsx)(y.Z,{icon:"mdi:close"})})]}),(0,a.jsx)(o.Z,{dividers:!0,sx:{overflow:"initial"},children:(0,a.jsxs)(d.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsxs)(c.Z,{sx:{display:"flex"},children:[(0,a.jsxs)(c.Z,{sx:{width:90,height:100,position:"relative"},children:[(0,a.jsx)(v(),{src:z,layout:"fill",objectFit:"cover",alt:"Avatar",style:{backgroundColor:"#fafafa",borderRadius:2,overflow:"hidden"}}),(0,a.jsx)("input",{hidden:!0,type:"file",ref:N,accept:"image/png, image/jpeg",onChange:es})]}),(0,a.jsxs)(c.Z,{sx:{px:5,py:3},children:[(0,a.jsx)(u.Z,{variant:"contained",sx:{mr:2},onClick:ee,children:"Choose Photo"}),(0,a.jsx)(u.Z,{variant:"contained",color:"error",onClick:et,children:"Reset Photo"}),(0,a.jsx)(l.Z,{sx:{color:"#EA5455",mt:4},children:"Allowed PNG or JPEG. Max size of 800KB"})]})]})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(m.Z,{label:"First Name",size:"small",value:E,onChange:e=>R(e.target.value)})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{label:"Last Name",size:"small",value:A,onChange:e=>I(e.target.value)})})}),(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{label:"Email",size:"small",value:D,onChange:e=>L(e.target.value)})})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{type:G?"text":"password",label:"Password",size:"small",value:F,onChange:e=>H(e.target.value),InputProps:{endAdornment:(0,a.jsx)(n.Z,{"aria-label":"toggle password visibility",onClick:$,onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(y.Z,{fontSize:"1.25rem",icon:G?"tabler:eye":"tabler:eye-off"})})}})})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{type:O?"text":"password",label:"Confirm Password",size:"small",value:B,onChange:e=>U(e.target.value),InputProps:{endAdornment:(0,a.jsx)(n.Z,{"aria-label":"toggle password visibility",onClick:Y,onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(y.Z,{fontSize:"1.25rem",icon:O?"tabler:eye":"tabler:eye-off"})})}})})}),(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsxs)(x.Z,{fullWidth:!0,children:[(0,a.jsx)(p.Z,{size:"small",children:"Report List"}),(0,a.jsx)(h.Z,{label:"Report List",size:"small",multiple:!0,value:K,sx:{"& .MuiInputBase-input":{display:"flex",justifyContent:"space-between"}},onChange:q,renderValue:e=>(0,a.jsx)(c.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,a.jsx)(Z.Z,{label:Q(e),color:"primary"},e))}),MenuProps:C,children:t.map((e,s)=>(0,a.jsx)(f.Z,{value:e._id,sx:{display:"flex",justifyContent:"space-between"},children:(0,a.jsx)(c.Z,{component:"span",children:e.name})},s))})]})})]})}),(0,a.jsxs)(j.Z,{sx:{pt:5},children:[(0,a.jsx)(u.Z,{variant:"contained",onClick:ea,children:"Update"}),(0,a.jsx)(u.Z,{variant:"contained",color:"error",onClick:S,children:"Cancel"})]})]})};s.default=S},5866:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(657),i=t(7645),l=t(5861),n=t(3946),o=t(6580),d=t(6886),c=t(7357),u=t(3321),m=t(1903),x=t(4054),p=t(3841),h=t(8360),Z=t(7918),f=t(8972),j=t(1425),g=t(5675),v=t.n(g),P=t(7294),w=t(6501),y=t(9878),b=t(1566);let C={PaperProps:{style:{maxHeight:224,width:250}}},S=e=>{let{open:s,reports:t,handleClose:g,initialize:S}=e,k=(0,P.useRef)(null),[N,z]=(0,P.useState)("/images/avatars/1.png"),[W,_]=(0,P.useState)(null),[M,E]=(0,P.useState)(""),[R,A]=(0,P.useState)(""),[I,D]=(0,P.useState)(""),[L,F]=(0,P.useState)(""),[H,B]=(0,P.useState)(""),[U,G]=(0,P.useState)(!1),[V,O]=(0,P.useState)(!1),[J,K]=(0,P.useState)([]);(0,P.useEffect)(()=>{s&&T()},[s]);let T=async()=>{z("/images/avatars/1.png"),E(""),A(""),D(""),F(""),B(""),K([])},X=()=>{G(!U)},$=()=>{O(!V)},Y=e=>{let{target:{value:s}}=e;K("string"==typeof s?s.split(","):s)},q=e=>{let s;return t.map((t,a)=>{t._id==e&&(s=t.name)}),s},Q=e=>{k.current.click()},ee=e=>{let s=e.target.files[0],t=new FileReader;_(s),t.onload=()=>z(t.result),t.readAsDataURL(s)},es=e=>{z("/images/avatars/1.png"),_(null)},et=async()=>{if(""===M.trim())w.ZP.error("Please enter a first name.");else if(""===R.trim())w.ZP.error("Please enter a last name.");else if(""===I.trim())w.ZP.error("Please enter a email.");else if(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g.test(I)){if(""===L.trim())w.ZP.error("Please enter a password.");else if(L.length<6)w.ZP.error("Password must be at least 6 characters");else if(""===H.trim())w.ZP.error("Please enter a confirm password.");else if(L!==H)w.ZP.error("Passwords must match");else if(0==J.length)w.ZP.error("Please select the report");else{let e=new FormData;W&&e.append("avatar",W),e.append("firstName",M),e.append("lastName",R),e.append("email",I),e.append("password",L),e.append("reports",J);let{data:s}=await b.Z.post("/admin/users",e);s.status?(w.ZP.success(s.msg),g(),S()):w.ZP.error(s.msg)}}else w.ZP.error("Please enter a valid email.")};return(0,a.jsxs)(r.Z,{fullWidth:!0,maxWidth:"xs",open:s,sx:{"& .MuiPaper-root":{maxWidth:600}},children:[(0,a.jsxs)(i.Z,{sx:{mb:3},children:[(0,a.jsx)(l.Z,{component:"span",variant:"h5",children:"New User"}),(0,a.jsx)(n.Z,{onClick:g,sx:{position:"absolute",right:12,top:10,color:"#aaa"},children:(0,a.jsx)(y.Z,{icon:"mdi:close"})})]}),(0,a.jsx)(o.Z,{dividers:!0,sx:{overflow:"initial"},children:(0,a.jsxs)(d.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsxs)(c.Z,{sx:{display:"flex"},children:[(0,a.jsxs)(c.Z,{sx:{width:90,height:100,position:"relative"},children:[(0,a.jsx)(v(),{src:N,layout:"fill",objectFit:"cover",alt:"Avatar",style:{backgroundColor:"#fafafa",borderRadius:10,overflow:"hidden"}}),(0,a.jsx)("input",{hidden:!0,type:"file",ref:k,accept:"image/png, image/jpeg",onChange:ee})]}),(0,a.jsxs)(c.Z,{sx:{px:5,py:3},children:[(0,a.jsx)(u.Z,{variant:"contained",sx:{mr:2},onClick:Q,children:"Choose Photo"}),(0,a.jsx)(u.Z,{variant:"contained",color:"error",onClick:es,children:"Reset Photo"}),(0,a.jsx)(l.Z,{sx:{color:"#EA5455",mt:4},children:"Allowed PNG or JPEG. Max size of 800KB"})]})]})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(m.Z,{label:"First Name",size:"small",value:M,onChange:e=>E(e.target.value)})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{label:"Last Name",size:"small",value:R,onChange:e=>A(e.target.value)})})}),(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{label:"Email",size:"small",value:I,onChange:e=>D(e.target.value)})})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{type:U?"text":"password",label:"Password",size:"small",value:L,onChange:e=>F(e.target.value),InputProps:{endAdornment:(0,a.jsx)(n.Z,{"aria-label":"toggle password visibility",onClick:X,onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(y.Z,{fontSize:"1.25rem",icon:U?"tabler:eye":"tabler:eye-off"})})}})})}),(0,a.jsx)(d.ZP,{item:!0,sm:6,xs:12,children:(0,a.jsx)(x.Z,{fullWidth:!0,children:(0,a.jsx)(m.Z,{type:V?"text":"password",label:"Confirm Password",size:"small",value:H,onChange:e=>B(e.target.value),InputProps:{endAdornment:(0,a.jsx)(n.Z,{"aria-label":"toggle password visibility",onClick:$,onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(y.Z,{fontSize:"1.25rem",icon:V?"tabler:eye":"tabler:eye-off"})})}})})}),(0,a.jsx)(d.ZP,{item:!0,sm:12,xs:12,children:(0,a.jsxs)(x.Z,{fullWidth:!0,children:[(0,a.jsx)(p.Z,{size:"small",children:"Report List"}),(0,a.jsx)(h.Z,{label:"Report List",size:"small",multiple:!0,value:J,sx:{"& .MuiInputBase-input":{display:"flex",justifyContent:"space-between"}},onChange:Y,renderValue:e=>(0,a.jsx)(c.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,a.jsx)(Z.Z,{label:q(e),color:"primary"},e))}),MenuProps:C,children:t.map((e,s)=>(0,a.jsx)(f.Z,{value:e._id,sx:{display:"flex",justifyContent:"space-between"},children:(0,a.jsx)(c.Z,{component:"span",children:e.name})},s))})]})})]})}),(0,a.jsxs)(j.Z,{sx:{pt:5},children:[(0,a.jsx)(u.Z,{variant:"contained",onClick:et,children:"Create"}),(0,a.jsx)(u.Z,{variant:"contained",color:"error",onClick:g,children:"Cancel"})]})]})};s.default=S},8077:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(480),i=t(2852),l=t(7357),n=t(3321),o=t(6886),d=t(6242),c=t(8445),u=t(5861),m=t(1903),x=t(7109),p=t(7720),h=t(4267),Z=t(3559),f=t(5675),j=t.n(f),g=t(1163),v=t(7294),P=t(6501),w=t(9878),y=t(8756),b=t(3626),C=t(8181),S=t(5866),k=t(1566),N=t(6737),z=t.n(N);let W=()=>{let{settings:e}=(0,y.r)(),s=(0,g.useRouter)(),[t,f]=(0,v.useState)([]),[b,N]=(0,v.useState)({}),[W,_]=(0,v.useState)([]),[M,E]=(0,v.useState)(""),[R,A]=(0,v.useState)(!1),[I,D]=(0,v.useState)(!1),[L,F]=(0,v.useState)(!1);(0,v.useEffect)(()=>{B()},[M,R]),(0,v.useEffect)(()=>{H()},[]);let H=async()=>{let{data:e}=await k.Z.get("/admin/reports");_(e)},B=async()=>{let{data:e}=await k.Z.get("/admin/users",{params:{search:M}});f(e)},U=()=>{D(!0)},G=(e,t)=>{e.stopPropagation(),s.push("/users/".concat(t))},V=(e,s)=>{e.stopPropagation(),N(s),F(!0)},O=async(e,s)=>{e.stopPropagation();let{data:t}=await k.Z.put("/admin/users/".concat(s,"/status"),{status:e.target.checked});t.status?(P.ZP.success(t.msg),A(e=>!e)):P.ZP.error(t.msg)},J=(e,s)=>{e.stopPropagation(),z()({title:"Are you sure?",text:"Once you delete it, you will not be revert it again.",icon:"warning",buttons:{confirm:{text:"Yes",className:"btn-primary"},cancel:{text:"Cancel",visible:!0,className:"btn-error"}},dangerMode:!0}).then(async e=>{if(e){let{data:e}=await k.Z.delete("/admin/users/".concat(s));e.status?(P.ZP.success(e.msg),A(e=>!e)):P.ZP.error(e.msg)}})};return(0,a.jsx)(o.ZP,{container:!0,spacing:6,children:(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(c.Z,{title:(0,a.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(u.Z,{variant:"h5",children:"User Management"}),(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(m.Z,{value:M,size:"small",onChange:e=>E(e.target.value),sx:{mr:2,"& .MuiInputBase-input":{height:"1.22em"}},InputProps:{startAdornment:(0,a.jsx)(x.Z,{position:"start",children:(0,a.jsx)(w.Z,{icon:"mdi:search"})})}}),(0,a.jsxs)(n.Z,{variant:"contained",size:"small",onClick:U,children:[(0,a.jsx)(w.Z,{icon:"mdi:plus"})," Create"]})]})]}),sx:{py:4}}),(0,a.jsx)(p.Z,{}),(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(Z._,{getRowId:e=>e._id,rowHeight:50,autoHeight:!0,columns:[{minWidth:20,field:"avatar",headerName:"",renderCell:e=>{let{row:s}=e;return(0,a.jsx)(j(),{src:s.avatar?"/uploads/users/".concat(s.avatar):"/images/avatars/1.png",width:"38",height:"38",alt:"avatar",style:{width:38,height:38,borderRadius:50,overflow:"hidden",background:"#fafafa"}})}},{minWidth:120,field:"firstName",headerName:"First Name",renderCell:e=>{let{row:s}=e;return s.firstName}},{minWidth:120,field:"lastName",headerName:"Last Name",renderCell:e=>{let{row:s}=e;return s.lastName}},{minWidth:150,field:"email",headerName:"Email",renderCell:e=>{let{row:s}=e;return s.email}},{flex:1,minWidth:120,field:"status",headerName:"Status",renderCell:e=>{let{row:s}=e;return(0,a.jsx)(r.Z,{label:s.status?"Active":"Inactive",control:(0,a.jsx)(i.Z,{checked:s.status,onChange:e=>O(e,s._id)})})}},{minWidth:140,field:"action",headerName:"Action",renderCell:e=>{let{row:s}=e;return(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(n.Z,{variant:"outlined",size:"small",sx:{minWidth:30,px:1,py:1,mr:2},color:"success",onClick:e=>G(e,s._id),children:(0,a.jsx)(w.Z,{icon:"mdi-eye"})}),(0,a.jsx)(n.Z,{variant:"outlined",size:"small",sx:{minWidth:30,px:1,py:1,mr:2},onClick:e=>V(e,s),children:(0,a.jsx)(w.Z,{icon:"mdi:pencil"})}),(0,a.jsx)(n.Z,{variant:"outlined",size:"small",sx:{minWidth:30,px:1,py:1},color:"error",children:(0,a.jsx)(w.Z,{icon:"mdi:delete",onClick:e=>J(e,s._id)})})]})}}],rows:t,sx:{"& .MuiDataGrid-columnHeaders":{minHeight:"0px !important",maxHeight:"80px !important",background:"dark"===e.mode&&"#25293c",border:"dark"===e.mode&&"1px solid #25293c"}}}),(0,a.jsx)(S.default,{open:I,reports:W,handleClose:()=>D(!1),initialize:()=>A(e=>!e)}),(0,a.jsx)(C.default,{open:L,reports:W,user:b,handleClose:()=>F(!1),initialize:()=>A(e=>!e)})]})]})})})};W.getLayout=e=>(0,a.jsx)(b.Z,{children:e}),s.default=W}},function(e){e.O(0,[502,72,886,792,675,53,774,888,179],function(){return e(e.s=7787)}),_N_E=e.O()}]);